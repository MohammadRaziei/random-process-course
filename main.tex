% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode

\documentclass[12pt,onecolumn,a4paper]{article}
\usepackage{amsthm,amsmath,amssymb,bm}
\usepackage{epsfig,graphicx,subcaption}
\usepackage{float}
\usepackage{color,xcolor}
\usepackage{fmtcount}
\usepackage{placeins}
\usepackage{adjustbox}


\usepackage{csvsimple}
\usepackage[top=1in, left=1in, right=1in, bottom=1in]{geometry}
\usepackage{nicefrac}
\usepackage{fancyhdr}
\usepackage{listings}
\usepackage{tabularx, booktabs, makecell}
\usepackage{hyperref,url}
\usepackage{listings}
\usepackage{natbib}
\usepackage{siunitx}

\usepackage{multirow}



\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usetikzlibrary{positioning}


\renewcommand{\baselinestretch}{1.5} 


\makeatletter
\let\old@lstKV@SwitchCases\lstKV@SwitchCases
\def\lstKV@SwitchCases#1#2#3{}
\makeatother
\usepackage{lstlinebgrd}
\makeatletter
\let\lstKV@SwitchCases\old@lstKV@SwitchCases

\lst@Key{numbers}{none}{%
	\def\lst@PlaceNumber{\lst@linebgrd}%
	\lstKV@SwitchCases{#1}%
	{none:\\%
		left:\def\lst@PlaceNumber{\llap{\normalfont
				\lst@numberstyle{\thelstnumber}\kern\lst@numbersep}\lst@linebgrd}\\%
		right:\def\lst@PlaceNumber{\rlap{\normalfont
				\kern\linewidth \kern\lst@numbersep
				\lst@numberstyle{\thelstnumber}}\lst@linebgrd}%
	}{\PackageError{Listings}{Numbers #1 unknown}\@ehc}}
\makeatother
\newcounter{subListing}[subfigure]



\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{mygreen}{RGB}{28,172,0} 
\definecolor{mylilas}{RGB}{170,55,241}
\definecolor{backcolour}{rgb}{1,1,0.98}

\lstset{language=MATLAB,%
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{blue},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\tt\scriptsize,
	frame = LBtr,
	%frameround=T,
	rulecolor=\color{gray},
	showstringspaces=false,
	numbers=left,%
	numberstyle={\tiny\color{gray}},
	numbersep=8pt,
	breaklines=true,
	%postbreak=\mbox{\textcolor{yellow}{$\hookrightarrow$}\space},
	tabsize=2,
	escapechar=`,
	xleftmargin=1.8 em, 
	framexleftmargin=2em,
}

\newcommand*{\transpose}{{\mkern-1.5mu\mathsf{T}}}


\usepackage{titlesec}
\titleformat{\section}[block]
{\titlerule\addvspace{4pt}\normalfont\fontsize{14}{16}\bfseries}
{\thesection\enspace}{0pt}{}[\vspace{2pt}\titlerule]


\usepackage{xepersian}
\settextfont{XB Niloofar}
\setmathdigitfont{Yas}

\newfloat{Listing}{htbp}{lop}[section] % 'lop' is the file extension, 'htbp' for float placement
\floatname{Listing}{کد}


\theoremstyle{definition}
\newtheorem{theorem}{قضیه}


\newcommand\question{
	\section{پاسخ سوال \tartibi{section}}
}


\author{
	محمد رضیئی فیجانی
}
\title{
	پاسخ تمرینات کامپیوتری سری اول فرایند تصادفی
}
\date{\today}


\newcounter{rownum} % Define a counter for the row number

\newcommand\makeresultcellNv[4]{
	\(
	\begin{matrix}
		a_{\text{est}} = 
		\begin{pmatrix}
			\csvreader[head=false, late after line=\\]{Q2/results/a-est-#2-N#3-v#4.csv}{}%
			{\num{\csvcoli}}
		\end{pmatrix}
		\\
		\text{#1} =
		\csvreader[head=false, 
		before reading=\setcounter{rownum}{0}, after line=\stepcounter{rownum} 
		]{Q2/results/a-est-#2-N#3-v#4-err.csv}{}%
		{\ifnum\therownum=0 \csvcoli \fi}
		\\
		\text{LSE} = 
		\csvreader[head=false, 
		before reading=\setcounter{rownum}{0}, after line=\stepcounter{rownum} 
		]{Q2/results/a-est-#2-N#3-v#4-err.csv}{}%
		{\ifnum\therownum=2 \num{\csvcoli} \fi}
		\\
		\nicefrac{\text{LSE}}{N} = 
		\csvreader[head=false, 
		before reading=\setcounter{rownum}{0}, after line=\stepcounter{rownum} 
		]{Q2/results/a-est-#2-N#3-v#4-err.csv}{}%
		{\ifnum\therownum=1 \num{\csvcoli} \fi}
	\end{matrix}
	\)
}




\begin{document}
	
	
	% Set the page style to "fancy"...
	\pagestyle{fancy}
	%... then configure it.
	%		\fancyhead{} % clear all header fields
	%		\fancyhead[RO,LE]{\textbf{The performance of new graduates}}
	%		\fancyfoot{} % clear all footer fields
	%		\fancyfoot[LE,RO]{\thepage}
	%		\fancyfoot[LO,CE]{From: K. Grant}
	%		\fancyfoot[CO,RE]{To: Dean A. Smith}
	\maketitle
	
	\section*{مقدمه}
	تمامی تمرینات در 
	\lr{Matlab R2024a}
	\cite{matlab2024a}
	توسعه پیدا کرده است.
	
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\FloatBarrier
	\question%{خودهمبستگی و همبستگی متقابل}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	

سلام
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\FloatBarrier
	\question%{خودهمبستگی و همبستگی متقابل}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	\begin{Listing}[H]
		\begin{latin}
			\lstinputlisting{Q2/poisson_points_process.m}
		\end{latin}
		\caption{کد تابع \texttt{poisson\_points\_process} جهت تولید نقاط پواسون با استفاده از توزیع نمایی}
	\end{Listing}
	
	
	\begin{theorem}
		در یک فرایند پواسون با نرخ \( \lambda \)، فاصله زمانی بین هر دو رویداد متوالی (یا همان زمان بین دو تماس) از توزیع نمایی با پارامتر \( \lambda \) پیروی می‌کند.
	\end{theorem}
	

	
	\begin{Listing}[H]
		\begin{latin}
			\lstinputlisting[lastline=10]{Q2/validate_poisson_points_process.m}
		\end{latin}
		\caption{کد تولید نقاط پواسون با استفاده از توزیع نمایی}
	\end{Listing}

\begin{table}[H]
	\centering
	\caption{جدول تحلیل درستی تابع \texttt{poisson\_points\_process}}
	\begin{tabular}{cccc}
		\toprule
		\textbf{شماره} & \textbf{زمان $T$} & $\nicefrac{\text{\textbf{میانگین}}}{T}$ & $\nicefrac{\text{\textbf{واریانس}}}{T}$ \\
		\midrule
		\csvreader[head=false,
		before reading=\setcounter{rownum}{1}, after line=\stepcounter{rownum} 
		]{Q2/results/samples-mean-var.csv}{}%
		{$\therownum$ & $\csvcoli$ & $\csvcolii$ & $\csvcoliii$ \\\midrule}
%		\bottomrule
	\end{tabular}
\end{table}


طبق جدول بالا
\begin{equation}
	\sigma^2 \simeq \eta \  \approx \  \lambda T
\end{equation}



		

	\begin{figure}[H]
		\centering
		\includegraphics[width=\linewidth]{Q2/results/poisson-points-process-60}
		\caption{}
		\label{fig:poisson-points-process-60}
	\end{figure}

	\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{Q2/results/poisson-process-60}
	\caption{}
	\label{fig:poisson-process-60}
\end{figure}




\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{Q2/results/mt-60}
	\caption{}
	\label{fig:mt-60}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{Q2/results/e-mt-lambda1-10.00-lambda2-0.50}
	\caption{}
	\label{fig:e-mt-1}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{Q2/results/e-mt-lambda1-20.00-lambda2-0.50}
	\caption{}
	\label{fig:e-mt-2}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{Q2/results/e-mt-lambda1-10.00-lambda2-0.10}
	\caption{}
	\label{fig:e-mt-3}
\end{figure}


\begin{equation}
	\mathbb{E}\big\{M(t)\big\} = \frac{\lambda_1}{\lambda_2} (1 - \mathrm{e}^{-\lambda_2 t})
\end{equation}


\begin{equation}
	\lim\limits_{t\to\infty} \mathbb{E}\big\{M(t)\big\} = 
	 \frac{\lambda_1}{\lambda_2} = 20
\end{equation}

	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\FloatBarrier
	\question%{خودهمبستگی و همبستگی متقابل}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


	\FloatBarrier
	\subsection{قسمت الف}
	

	
	\begin{figure}[H]
		\centering
		\includegraphics[width=\linewidth]{Q3/results/hist-1}
		\caption{}
		\label{fig:hist-1}
	\end{figure}


		
	\begin{figure}[H]
		\centering
		\includegraphics[width=.5\linewidth]{Q3/results/px-1}
		\caption{}
		\label{fig:px-1}
	\end{figure}
	

	\FloatBarrier
	\subsection{قسمت ب}
	
	
	\begin{figure}[H]
		\centering
		\includegraphics[width=\linewidth]{Q3/results/hist-2}
		\caption{}
		\label{fig:hist-2}
	\end{figure}


		
	\begin{figure}[H]
		\centering
		\includegraphics[width=.5\linewidth]{Q3/results/px-2}
		\caption{}
		\label{fig:px-2}
	\end{figure}
	
	
	\FloatBarrier
	\subsection{قسمت پ}

		
	\begin{figure}[H]
		\centering
		\includegraphics[width=\linewidth]{Q3/results/hist-3}
		\caption{}
		\label{fig:hist-3}
	\end{figure}


		
	\begin{figure}[H]
		\centering
		\includegraphics[width=.5\linewidth]{Q3/results/px-3}
		\caption{}
		\label{fig:px-3}
	\end{figure}
	

	
	\FloatBarrier
	\subsection{قسمت ت}

		
	\begin{figure}[H]
		\centering
		\includegraphics[width=\linewidth]{Q3/results/hist-4}
		\caption{}
		\label{fig:hist-4}
	\end{figure}


		
	\begin{figure}[H]
		\centering
		\includegraphics[width=.5\linewidth]{Q3/results/px-4}
		\caption{}
		\label{fig:px-4}
	\end{figure}

	
	\FloatBarrier
	\subsection{قسمت ث}

		
	\begin{figure}[H]
		\centering
		\includegraphics[width=\linewidth]{Q3/results/hist-5}
		\caption{}
		\label{fig:hist-5}
	\end{figure}


		
	\begin{figure}[H]
		\centering
		\includegraphics[width=.5\linewidth]{Q3/results/px-5}
		\caption{}
		\label{fig:px-5}
	\end{figure}
	
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\newpage
	\bibliographystyle{plainnat-fa}
	%\nocite{*}
	\bibliography{references}
	
	
\end{document}